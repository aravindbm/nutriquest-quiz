<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriNCD QUEST 2025</title>
    <style>
        :root { --primary: #0066cc; --bg: #f4f7f6; --text: #333; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; }
        
        /* Layout */
        .container { max-width: 600px; margin: 0 auto; background: white; min-height: 100vh; box-shadow: 0 0 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .content-padding { padding: 25px; }

        /* Header Styling */
        .header-row { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px; }
        .flank-img { width: 50px; height: auto; object-fit: contain; }
        
        .title-text { font-size: 1.8rem; font-weight: 800; margin: 0; text-align: center; line-height: 1.2; }
        .txt-nutri { color: #28a745; } /* Green */
        .txt-ncd { color: #dc3545; }   /* Red */
        .txt-quest { color: #007bff; } /* Blue */

        .dept-logo-container { text-align: center; margin: 15px 0 25px 0; }
        .dept-logo { width: 140px; height: auto; }

        .sub-title { text-align: center; color: #666; font-size: 0.9rem; margin-bottom: 20px; font-weight: 600; }

        /* Inputs & Buttons */
        input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        .btn { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; }
        .btn:disabled { background: #ccc; }

        /* Timer - Sticky Header */
        .timer-sticky { 
            position: sticky; 
            top: 0; 
            background: #fff; 
            padding: 15px; 
            border-bottom: 3px solid var(--primary); 
            z-index: 1000; 
            text-align: center; 
            font-weight: bold; 
            color: #d9534f; 
            font-size: 1.4rem; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Questions */
        .question-card { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .question-text { font-weight: 600; font-size: 1.1rem; margin-bottom: 15px; line-height: 1.4; }
        .options label { display: flex; align-items: flex-start; padding: 10px; margin-bottom: 5px; background: #fafafa; border-radius: 6px; cursor: pointer; }
        .options input { width: 20px; height: 20px; margin: 0 10px 0 0; flex-shrink: 0; }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container" id="screen-welcome">
    <div class="content-padding">
        <div class="header-row">
            <img src="Nutrition.png" alt="Nutri" class="flank-img">
            <h1 class="title-text">
                <span class="txt-nutri">Nutri</span><span class="txt-ncd">NCD</span> <span class="txt-quest">QUEST</span>
            </h1>
            <img src="NCDs.png" alt="NCD" class="flank-img">
        </div>

        <div class="sub-title">30th AP State Joint IAPSM & IPHA Conference<br>Andhra Medical College, Visakhapatnam.</div>

        <div class="dept-logo-container">
            <img src="SPM_AMC_LOGO.png" alt="Department Logo" class="dept-logo">
        </div>
        
        <div style="background: #eef5fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9rem;">
            <strong>Rules:</strong>
            <ul style="padding-left: 20px; margin: 5px 0;">
                <li>20 Questions | No Negative Marks</li>
                <li>Tie-Breaker: Fastest Time</li>
                <li>Top 6 Qualify for the Finals & Quiz Master's decision shall be final and binding </li>
            </ul>
        </div>

        <form onsubmit="event.preventDefault(); startQuiz();">
            <input type="text" id="fname" placeholder="Full Name" required>
            <input type="text" id="cname" placeholder="College Name" required>
            <input type="email" id="email" placeholder="Email Address" required>
            <input type="text" id="passkey" placeholder="Passkey" autocomplete="off" required>
            <button class="btn" type="submit">Start Quiz</button>
        </form>
    </div>
</div>

<div class="container hidden" id="screen-quiz">
    <div class="timer-sticky" id="timer">00:00</div>
    
    <div class="content-padding">
        <div id="quiz-content"></div>
        <button class="btn" onclick="submitQuiz()" id="submitBtn">Submit Assessment</button>
    </div>
</div>

<div class="container hidden" id="screen-result">
    <div class="content-padding" style="text-align: center; margin-top: 40px;">
        <h1 style="color: #28a745; font-size: 3rem;">âœ”</h1>
        <h2>Submitted Successfully!</h2>
        <p>Your responses have been recorded.</p>
        //<p>Please check your email for your Score and the Answer Key.</p>
        <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
        <p style="color: #999; font-size: 0.8rem;">Department of Community Medicine<br>Andhra Medical College</p>
    </div>
</div>

<script>
    // --- CONFIGURATION ---
    const CORRECT_PASSKEY = "AMC2025"; 
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx6S-1Q7s62c0Yl15xPBXiNYbbC4UZyg0YxBoR0AJdJu_GTGsI5otc5pwKHZ_WV58BGiQ/exec"; // <--- PASTE YOUR URL HERE

    // --- QUESTION DB ---
    const db = [
        { q: "According to ICMR-NIN 2024, which age bracket defines the 'Reference Indian Adult'?", opts: ["19-39 years", "18-29 years", "25-45 years", "20-49 years"], ans: "19-39 years" },
        { q: "The WHO 2023 guideline on Non-Sugar Sweeteners (NSS) recommends against their use for weight control. Which is an NSS?", opts: ["Medicinal syrups", "Stevia and its derivatives", "Sugar alcohols (Polyols)", "Low-calorie sugars"], ans: "Stevia and its derivatives" },
        { q: "Which NOVA food classification category is most strongly associated with obesity and metabolic syndrome?", opts: ["Group 1: Unprocessed foods", "Group 3: Processed foods", "Group 4: Ultra-processed foods", "Group 2: Culinary ingredients"], ans: "Group 4: Ultra-processed foods" },
        { q: "Per ICMR-NIN 2024, what is the recommendation regarding protein powders for the general adult population?", opts: ["Safe up to 2.0g/kg/day", "Recommended to meet RDA", "Avoided; associated with renal/bone issues", "Recommended only for vegetarians"], ans: "Avoided; associated with renal/bone issues" },
        { q: "Which study design is most prone to 'Reverse Causality' when assessing diet and chronic disease?", opts: ["Prospective Cohort Study", "Cross-sectional Study", "Randomized Controlled Trial", "Ecological Study"], ans: "Cross-sectional Study" },
        { q: "Which fatty acid profile change is most effective in reducing LDL cholesterol?", opts: ["Increasing MCTs", "Replacing SFA with PUFA", "Replacing SFA with Carbohydrates", "Replacing Trans fats with SFA"], ans: "Replacing SFA with PUFA" },
        { q: "What is the correct formula for Glycemic Load (GL)?", opts: ["(Glycemic Index x Carbohydrate (g)) / 100", "Glycemic Index x Dietary Fiber", "(Carbohydrate / GI) x 100", "(GI x Total Food Weight) / 100"], ans: "(Glycemic Index x Carbohydrate (g)) / 100" },
        { q: "What is the primary characteristic of the protein source in the EAT-Lancet 'Planetary Health Diet'?", opts: ["Exclusive veganism", "High reliance on dairy/eggs", "Predominantly plant-based proteins", "Processed soy isolates"], ans: "Predominantly plant-based proteins" },
        { q: "Which anthropometric indicator is suggested by the Ashwell Shape Chart?", opts: ["Waist-to-Hip Ratio (WHR)", "Mid-Upper Arm Circumference", "Body Mass Index", "Waist-to-Height Ratio (WHtR)"], ans: "Waist-to-Height Ratio (WHtR)" },
        { q: "What is the NIN recommended daily dietary fiber intake for an adult man?", opts: ["50-60 g/day", "10 g/day", "25-30 g/day", "15-20 g/day"], ans: "25-30 g/day" },
        { q: "Which FOPL system uses a graded summary indicator (colors and letters) to rank nutritional quality?", opts: ["Multiple Traffic Light", "Nutri-Score", "GDA", "Warning Labels"], ans: "Nutri-Score" },
        { q: "Deficiency of which triad of vitamins is primarily responsible for hyperhomocysteinemia?", opts: ["Folic Acid, Vitamin B12, Vitamin B6", "Vitamin A, Vitamin D, Vitamin E", "Thiamine, Riboflavin, Niacin", "Vitamin C, Vitamin E, Selenium"], ans: "Folic Acid, Vitamin B12, Vitamin B6" },
        { q: "Besides reducing Sodium, which minerals are increased in the DASH diet?", opts: ["Potassium, Magnesium, Calcium", "Phosphorus, Sulfur, Chloride", "Selenium, Iodine, Chromium", "Iron, Zinc, Copper"], ans: "Potassium, Magnesium, Calcium" },
        { q: "Which method is the standard for assessing 'Long-term/Habitual' dietary intake in epidemiology?", opts: ["Biomarkers", "Weighed Food Record", "Food Frequency Questionnaire (FFQ)", "24-Hour Recall"], ans: "Food Frequency Questionnaire (FFQ)" },
        { q: "What is the WHO 'REPLACE' target limit for industrially-produced Trans-Fatty Acids (iTFA)?", opts: ["Less than 5% of total fat", "Less than 10% of total energy", "Zero detection", "Less than 2 g per 100 g of total fat"], ans: "Less than 2 g per 100 g of total fat" }
        { q: "According to the 'iceberg' concept of disease in the context of Type 2 Diabetes?", options: ["Most cases are Type 1 (Insulin Dependent)","The disease is fatal in 90% of cases", "A large percentage of cases remain undiagnosed or 'hidden' in the community", "Symptoms are severe in the early stages"], correct: "A large percentage of cases remain undiagnosed or 'hidden' in the community" },
        { q: "Epidemic dropsy is caused by the contamination of mustard oil with which of the following?", options: [ "Argemone oil","BOAA (Beta oxalyl amino alanine", "Aflatoxins", "Ergot"], correct: "Argemone oil" }
	    { q: "In the context of Vitamin A deficiency, which of the following prevalence criteria in children (6 months to 6 years) indicates a public health problem? ", options: [ "Night blindness > 5%", "Bitot's spots > 0.5%", "Corneal xerosis > 0.1%", "Serum retinol (< 10 mcg/dl) > 10%"], correct: "Bitot's spots > 0.5%" } 
	    { q: "In the epidemiology of hypertension, the 'Rule of Halves' suggests that:", options: [ "Only half the population has normal blood pressure", "Roughly half of the hypertensive subjects in the general population are aware of the condition", "Half of the complications are due to stroke", "Half of the risk factors are modifiable"], correct: "Roughly half of the hypertensive subjects in the general population are aware of the condition" }
	    { q: "According to the classification of malnutrition, Severe Acute Malnutrition (SAM) in children is defined by a Mid-Upper Arm Circumference (MUAC) of ", options: [ "< 13.5 cm", "< 12.5 cm", "< 11.5 cm", "< 10.0 cm"], correct: "< 11.5 cm" }    
    ];

    let questions = [];
    let startTime;
    let timerInt;

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function formatTime(totalSeconds) {
        const m = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
        const s = (totalSeconds % 60).toString().padStart(2, '0');
        return `${m}:${s}`;
    }

    function startQuiz() {
        if(document.getElementById('passkey').value !== CORRECT_PASSKEY) { alert("Incorrect Passkey!"); return; }

        document.getElementById('screen-welcome').classList.add('hidden');
        document.getElementById('screen-quiz').classList.remove('hidden');

        questions = shuffle([...db]);
        const container = document.getElementById('quiz-content');
        
        questions.forEach((item, idx) => {
            let opts = shuffle([...item.opts]);
            let html = `
            <div class="question-card">
                <div class="question-text">Q${idx+1}. ${item.q}</div>
                <div class="options">
                    ${opts.map(o => `<label><input type="radio" name="q${idx}" value="${o}"> ${o}</label>`).join('')}
                </div>
            </div>`;
            container.insertAdjacentHTML('beforeend', html);
        });

        startTime = new Date();
        timerInt = setInterval(() => {
            let elapsed = Math.floor((new Date() - startTime)/1000);
            document.getElementById('timer').innerText = formatTime(elapsed);
        }, 1000);
        
        window.scrollTo(0,0);
    }

    function submitQuiz() {
        clearInterval(timerInt);
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.innerText = "Submitting...";
        
        const endTime = new Date();
        const timeTaken = Math.floor((endTime - startTime)/1000);
        
        let score = 0;
        let answers = [];
        
        questions.forEach((item, idx) => {
            const selected = document.querySelector(`input[name="q${idx}"]:checked`);
            const val = selected ? selected.value : "Not Answered";
            if(val === item.ans) score++;
            answers.push({ q: item.q, yourAns: val, correct: item.ans });
        });

        const payload = {
            name: document.getElementById('fname').value,
            college: document.getElementById('cname').value,
            email: document.getElementById('email').value,
            score: score,
            timeTaken: timeTaken, // Sending raw seconds for easy sorting in Excel
            answers: answers
        };

        fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        }).then(() => {
            document.getElementById('screen-quiz').classList.add('hidden');
            document.getElementById('screen-result').classList.remove('hidden');
        }).catch(e => {
            alert("Error submitting. Please check your internet connection.");
            submitBtn.disabled = false;
            submitBtn.innerText = "Submit Assessment";
        });
    }
</script>

</body>
</html>



